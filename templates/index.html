<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Stacker6X Vulnerability Classifier</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 5% 7%; 
    }

  .container {
      max-width: 100%;
      margin: auto;
      background: #f5f5f5;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);

    textarea {
      width: 75%;
      height: 50%
      margin: 5px 0;
      background-color: #282c35;
      color: white;
      padding: 2%
    }
input[type="file"] {
      width: 75%;
      margin: 10px 0;
      background-color: #f5f5f5;
      color: white;
    }

    button {
      padding: 8px 16px;
      cursor: pointer;
    }
    #result {
      margin-top: 10px;
      font-weight: bold;
      color: darkblue;
    }
  </style>
</head>
<body>

  <h1 style="font-weight: 900;">Stacker<span style="color: #666666;">6X.</span></h1>
	<h3 style="display:block; margin-top:6px;">Vulnerability and Attack Detector</span></h1>

   <p style="width: 75%;">Enter code/query le to check for malicious conten nter code/query or uploe to check for malicious conten nter code/query or upload a file to check for malicious conten nter code/query or upload a file to check</p>

   <p>Enter code/query or upload a file to check for malicious content:</p>

<div class="container">
<form id="predictForm">
    <label for="textInput">Enter text:</label><br>
    <textarea id="textInput" rows="6" placeholder="Type code, query, or payload here..."></textarea><br>

    <label for="fileInput">Or upload a file (Max 2MB):</label><br>
    <input type="file" id="fileInput" accept=".txt,.sql,.html,.js,.py,.log"><br><br>

    <button type="submit">Check</button>
  </form>
  <p id="result"></p>

  <script>
    document.getElementById('predictForm').addEventListener('submit', async function(e) {
      e.preventDefault();

      let text = document.getElementById('textInput').value.trim();
      const fileInput = document.getElementById('fileInput').files[0];

      if (!text && fileInput) {
        // ✅ Enforce 2 MB limit
        if (fileInput.size > 2 * 1024 * 1024) {
          document.getElementById('result').innerText = "❌ File too large! Max size is 2MB.";
          return;
        } 


        // Read file if no manual text input
        const reader = new FileReader();
        reader.onload = async function(e) {
          text = e.target.result;
          await sendToAPI(text);
        };
        reader.readAsText(fileInput);
      } else if (text) {
        await sendToAPI(text);
      } else {
        document.getElementById('result').innerText = "Please enter text or upload a file.";
      }
    });

    async function sendToAPI(text) {
      try {
        const response = await fetch("https://api.stacker6x.com/predict", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({ text: text })
        });

        const data = await response.json();
        document.getElementById('result').innerText = "Prediction: " + JSON.stringify(data);
      } catch (error) {
        document.getElementById('result').innerText = "Error: " + error;
      }
    }
  </script>
</div>
</body>
</html>
